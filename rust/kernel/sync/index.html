<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Synchronisation primitives."><meta name="keywords" content="rust, rustlang, rust-lang, sync"><title>kernel::sync - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../../normalize.css"><link rel="stylesheet" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../../ayu.css" disabled><link rel="stylesheet" href="../../dark.css" disabled><link rel="stylesheet" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script defer src="../../main.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../logo.svg"><style>body { padding-bottom: 30px; }</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../kernel/index.html"><div class="logo-container"><img class="rust-logo" src="../../logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../kernel/index.html"><div class="logo-container"><img class="rust-logo" src="../../logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module sync</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../index.html">kernel</a>::<wbr><a class="mod" href="#">sync</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/kernel/sync.rs.html#3-169">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Synchronisation primitives.</p>
<p>This module contains the kernel APIs related to synchronisation that have been ported or
wrapped for usage by Rust code in the kernel.</p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// SAFETY: `init` is called below.
</span><span class="kw">let </span><span class="kw-2">mut </span>data = Pin::from(Box::try_new(<span class="kw">unsafe </span>{ Mutex::new(<span class="number">10</span>) }).unwrap());
<span class="macro">mutex_init!</span>(data.as_mut(), <span class="string">&quot;test::data&quot;</span>);

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>data.lock(), <span class="number">10</span>);
<span class="kw-2">*</span>data.lock() = <span class="number">20</span>;
<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>data.lock(), <span class="number">20</span>);</code></pre></div>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="rcu/index.html" title="kernel::sync::rcu mod">rcu</a></div><div class="item-right docblock-short">RCU support.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="smutex/index.html" title="kernel::sync::smutex mod">smutex</a></div><div class="item-right docblock-short">A simple mutex implementation.</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Arc.html" title="kernel::sync::Arc struct">Arc</a></div><div class="item-right docblock-short">A reference-counted pointer to an instance of <code>T</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ArcBorrow.html" title="kernel::sync::ArcBorrow struct">ArcBorrow</a></div><div class="item-right docblock-short">A borrowed reference to an <a href="struct.Arc.html" title="Arc"><code>Arc</code></a> instance.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CondVar.html" title="kernel::sync::CondVar struct">CondVar</a></div><div class="item-right docblock-short">Exposes the kernel’s <a href="../../../include/linux/wait.h"><code>struct wait_queue_head</code></a> as a condition variable. It allows the caller to
atomically release the given lock and go to sleep. It reacquires the lock when it wakes up. And
it wakes up when notified by another thread (via <a href="struct.CondVar.html#method.notify_one" title="CondVar::notify_one"><code>CondVar::notify_one</code></a> or
<a href="struct.CondVar.html#method.notify_all" title="CondVar::notify_all"><code>CondVar::notify_all</code></a>) or because the thread received a signal.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Guard.html" title="kernel::sync::Guard struct">Guard</a></div><div class="item-right docblock-short">Allows mutual exclusion primitives that implement the <a href="trait.Lock.html" title="Lock"><code>Lock</code></a> trait to automatically unlock
when a guard goes out of scope. It also provides a safe and convenient way to access the data
protected by the lock.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.LockClassKey.html" title="kernel::sync::LockClassKey struct">LockClassKey</a></div><div class="item-right docblock-short">Represents a lockdep class. It’s a wrapper around C’s <code>lock_class_key</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.LockedBy.html" title="kernel::sync::LockedBy struct">LockedBy</a></div><div class="item-right docblock-short">Allows access to some data to be serialised by a lock that does not wrap it.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Mutex.html" title="kernel::sync::Mutex struct">Mutex</a></div><div class="item-right docblock-short">Exposes the kernel’s <a href="../../../include/linux/mutex.h"><code>struct mutex</code></a>. When multiple threads attempt to lock the same mutex,
only one at a time is allowed to progress, the others will block (sleep) until the mutex is
unlocked, at which point another thread will be allowed to wake up and make progress.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.NoWaitLock.html" title="kernel::sync::NoWaitLock struct">NoWaitLock</a></div><div class="item-right docblock-short">A lock that only offers a <a href="struct.NoWaitLock.html#method.try_lock"><code>try_lock</code></a> method.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.NoWaitLockGuard.html" title="kernel::sync::NoWaitLockGuard struct">NoWaitLockGuard</a></div><div class="item-right docblock-short">A guard for the holder of the no-wait lock.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RawSpinLock.html" title="kernel::sync::RawSpinLock struct">RawSpinLock</a></div><div class="item-right docblock-short">Exposes the kernel’s <a href="../../../include/linux/spinlock.h"><code>raw_spinlock_t</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ReadLock.html" title="kernel::sync::ReadLock struct">ReadLock</a></div><div class="item-right docblock-short">A marker for locks that only allow reading.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Revocable.html" title="kernel::sync::Revocable struct">Revocable</a></div><div class="item-right docblock-short">Revocable synchronisation primitive.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RevocableGuard.html" title="kernel::sync::RevocableGuard struct">RevocableGuard</a></div><div class="item-right docblock-short">A guard that allows access to a revocable object and keeps it alive.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RwSemaphore.html" title="kernel::sync::RwSemaphore struct">RwSemaphore</a></div><div class="item-right docblock-short">Exposes the kernel’s <a href="../../../include/linux/rwsem.h"><code>struct rw_semaphore</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SeqLock.html" title="kernel::sync::SeqLock struct">SeqLock</a></div><div class="item-right docblock-short">Exposes sequential locks backed by the kernel’s <code>seqcount_t</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SeqLockReadGuard.html" title="kernel::sync::SeqLockReadGuard struct">SeqLockReadGuard</a></div><div class="item-right docblock-short">Allows read-side access to data protected by a sequential lock.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SpinLock.html" title="kernel::sync::SpinLock struct">SpinLock</a></div><div class="item-right docblock-short">Exposes the kernel’s <a href="../../../include/linux/spinlock.h"><code>spinlock_t</code></a>. When multiple CPUs attempt to lock the same spinlock, only
one at a time is allowed to progress, the others will block (spinning) until the spinlock is
unlocked, at which point another CPU will be allowed to make progress.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.StaticArc.html" title="kernel::sync::StaticArc struct">StaticArc</a></div><div class="item-right docblock-short">Allows the creation of “reference-counted” globals.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.UniqueArc.html" title="kernel::sync::UniqueArc struct">UniqueArc</a></div><div class="item-right docblock-short">A refcounted object that is known to have a refcount of 1.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.WriteLock.html" title="kernel::sync::WriteLock struct">WriteLock</a></div><div class="item-right docblock-short">A marker for locks that allow reading and writing.</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Lock.html" title="kernel::sync::Lock trait">Lock</a></div><div class="item-right docblock-short">A generic mutual exclusion primitive.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.LockFactory.html" title="kernel::sync::LockFactory trait">LockFactory</a></div><div class="item-right docblock-short">A creator of instances of a mutual exclusion (lock) primitive.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.LockInfo.html" title="kernel::sync::LockInfo trait">LockInfo</a></div><div class="item-right docblock-short">Specifies properties of a lock.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.LockIniter.html" title="kernel::sync::LockIniter trait">LockIniter</a></div><div class="item-right docblock-short">A lock that can be initialised with a single lock class key.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.NeedsLockClass.html" title="kernel::sync::NeedsLockClass trait">NeedsLockClass</a></div><div class="item-right docblock-short">A trait for types that need a lock class during initialisation.</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.cond_resched.html" title="kernel::sync::cond_resched fn">cond_resched</a></div><div class="item-right docblock-short">Reschedules the caller’s task if needed.</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.new_refcount.html" title="kernel::sync::new_refcount fn">new_refcount</a></div><div class="item-right docblock-short">Creates, from a const context, a new instance of <code>struct refcount_struct</code> with a refcount of 1.</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.RevocableMutex.html" title="kernel::sync::RevocableMutex type">RevocableMutex</a></div><div class="item-right docblock-short">A revocable mutex.</div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.RevocableMutexGuard.html" title="kernel::sync::RevocableMutexGuard type">RevocableMutexGuard</a></div><div class="item-right docblock-short">A guard for a revocable mutex.</div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.RevocableRwSemaphore.html" title="kernel::sync::RevocableRwSemaphore type">RevocableRwSemaphore</a></div><div class="item-right docblock-short">A revocable rw semaphore.</div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.RevocableRwSemaphoreGuard.html" title="kernel::sync::RevocableRwSemaphoreGuard type">RevocableRwSemaphoreGuard</a></div><div class="item-right docblock-short">A guard for a revocable rw semaphore..</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="kernel" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.0 (69f9c33d7 2022-12-12)" ></div><div style="position: fixed; bottom: 0; left: 0; background-color: #FFC2AA; width: 100%; color: black; padding: 3px; text-align: center; z-index: 999;">This documentation is an old archive. Please see <a style="color: #671b00; text-decoration-line: underline;" href="https://rust.docs.kernel.org">https://rust.docs.kernel.org</a> instead.</div></body></html>